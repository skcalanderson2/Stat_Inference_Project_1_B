---
title: "Comparison of Vitamin C Supplement and Dosages in Guinea Pigs"
author: "Al Anderson"
date: "July 18, 2015"
output: pdf_document
---
```{r setup, echo=FALSE,message=FALSE, warning=FALSE}
library(knitr)
library(ggplot2)
library(dplyr)
tg <- ToothGrowth
```  
## Overview
This report does a comparison of data generated by a study of guinea pigs' tooth growth, designated as len. The study consisted of 60 animals divided into 6 different groups. There were two types of Vitamin C supplement studied: orange juice, OJ, and pure vitamin C, VC. There were 3 dosages studied, 0.5 mg, 1 mg, & 2 mg. The 6 groups where based on combinations of these two things:
```{r kable, echo=FALSE}
gp_df <- data.frame(supp = c("OJ","VC","OJ","VC","OJ","VC"), dose = c(0.5,0.5,1,1,2,2))
kable(gp_df)
```  

No data processing was done because data was in good form.

## Analysis
The data consists of 60 rows with columns of len, supp, and dose. The mean of the len is ```r round(mean(tg$len),2) ``` microns and a standard deviation of the length is ```r round(sd(tg$len),2)```.
Figure 1 is a bar graph of the means of each group. It is clear that there are some differences between the supplement-dosage groups.

```{r figure_1, echo = FALSE, fig.height=2, fig.width=5}
tg_grouped_by_supp_dose <- tg %>% group_by(supp, dose)
summary_supp_dose <- tg_grouped_by_supp_dose %>% summarise(means = mean(len), sd = sd(len))
summary_supp_dose <- summary_supp_dose %>% mutate(label = paste(supp, dose, sep = "-"))
summary_supp_dose$label <- as.factor(summary_supp_dose$label)
summary_supp_dose$lbl2 <- reorder(summary_supp_dose$label, summary_supp_dose$means)

g <- ggplot(summary_supp_dose, aes(y = means, x = lbl2, fill = supp))
g + geom_bar(stat = "identity") + xlab("Suppliment-Dose Category") + ylab("Means of Length") + ggtitle("Figure 1")
```

First we will try to determine if there is a difference between the individual supplement-dosage groups. Figure 2 show an xy plot of all the data with the color representing the two supplement groups. It clearly demonstrates that for the lower two dosages there is a difference in tooth growth, but for the 2.0 mg does there is no clear difference between the supplement types.

```{r figure_2, echo = FALSE, fig.height=3, fig.width=5}
qplot(as.factor(dose), len, data = tg, 
      color = as.factor(supp), 
      xlab = "Dosage(mg)", 
      ylab = "Tooth Length (microns)", 
      main = "Figure 2")
```

In order to establish a better understanding of the differences, t tests where performed between the various groups to determine if there is a real difference between the groups.

### Difference Between Suppliments
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us $p=0.06$ which is more than $\alpha$. This was done using the R code ```t.test(len ~ supp, data = tg, conf.level = 0.95)```. This $p$ leads us to accept $H_{0}$ in this case.

```{r echo=FALSE}
tg_5_1 <- tg %>% filter(dose == .5 | dose == 1.0)
t_tg_5_1 <- t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)$p.value
```
However, if we look at the differences between the supplements with the 2 mg groups removed we get $p=0.004$ which would lead us to reject $H_{0}$ for the lower dosages.

### Difference Between Dosages
We look at 3 different comparisons, 0.5 mg vs 1 mg, 0.5 mg vs 2 mg, 1 mg vs 2 mg. Table 2 gives us those values.

```{r echo=FALSE}
p_comp <- data.frame(Dosage_0_5_mg = c(.006,"-","-"), Dosage_1_mg = c("-",.001,"-"), Dosage_2_mg = c("-","-",.96), row.names = c("0.5 mg", "1 mg", "2 mg"))
kable(p_comp, caption = expression("p Values of Suppliment - Dosage Groups"))

```

#### 0.5 mg Group
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=0.006$ which is less than $\alpha$. This was done using the R code ```t.test(len ~ supp, data = tg_5, conf.level = 0.95)```. This $p$ leads us to reject $H_{0}$ in this case.

#### 1.0 mg Group
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=0.001$ which is less than $\alpha$. This was done using the R code ```t.test(len ~ supp, data = tg_1, conf.level = 0.95)```. This $p$ leads us to reject $H_{0}$ in this case.

#### 1.0 mg Group
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=0.96$ which is more than $\alpha$. This was done using the R code ```t.test(len ~ supp, data = tg_2, conf.level = 0.95)```. This $p$ leads us to accept $H_{0}$ in this case.

```{r echo= FALSE}
tg_1_2 <- tg %>% filter(dose == 2.0 | dose == 1.0)
t_tg_1_2 <- t.test(len ~ dose, data = tg_1_2, conf.level = 0.95)$p.value
tg_5_1 <- tg %>% filter(dose == .5 | dose == 1.0)
t_tg_5_1 <- t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)$p.value
tg_5_2 <- tg %>% filter(dose == .5 | dose == 2.0)
t_tg_5_2 <- t.test(len ~ dose, data = tg_5_2, conf.level = 0.95)$p.value
```


#### 0.5 mg vs 1.0 mg
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=```r t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)$p.value```$ which is far less than $\alpha$. This was done using the R code ```t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)```. This $p$ leads us to reject $H_{0}$ in this case.

#### 1.0 mg vs 2.0 mg
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=```r t.test(len ~ dose, data = tg_1_2, conf.level = 0.95)$p.value```$ which is far less than $\alpha$. This was done using the R code ```t.test(len ~ dose, data = tg_1_2, conf.level = 0.95)```. This $p$ leads us to reject $H_{0}$ in this case.

#### 0.5 mg vs 2.0 mg
Doing a test for $H_{0}=\text{No Difference Between Means}$ with an $\alpha = 0.5$ gives us a  $p=```r t.test(len ~ dose, data = tg_5_2, conf.level = 0.95)$p.value```$ which is far less than $\alpha$. This was done using the R code ```t.test(len ~ dose, data = tg_5_2, conf.level = 0.95)```. This $p$ leads us to reject $H_{0}$ in this case.

## Conclusion

### Assumptions
For this analysis and conclusion we assume that all other aspects of the animals diet are identical, that the ages are close, and that they have similar environments. If other words all the other conditions that may affect tooth growth are the same for all the groups and there are no other factors leading to an increase in tooth growth. 

Using the analysis data from above, it appears that all the *NULL* hypotheses concerning the differences, i.e. $\mu_{1}=\mu_{2}$, between the groups can be rejected accept for the $H_{0}$ of $\mu_{OJ-2mg} = \mu_{VC-2mg}$.

```{r echo=FALSE}
p_comp <- data.frame(Dosage_0_5_mg = c("OJ > VC","-","-"), Dosage_1_mg = c("-","OJ > VC","-"), Dosage_2_mg = c("-","-","OJ=VC"), row.names = c("0.5 mg", "1 mg", "2 mg"))
kable(p_comp, caption = expression("Conclusions of Suppliment - Dosage Groups"))

```

Overall, it does appear that Vitamin C does increase the growth of the guinea pig's teeth, but without a control group it is a stretch to reach this conclusion.

Finally, as the analysis above shows,$p=0.6$ between the overall supplement groups shows that OJ does not cause more tooth growth than VC. The box plot in figure 3 also demonstrates this. An anomaly to explore more is that if the comparison is done between the supplements with the 2 mg groups removed, with $p=0.004$ and as the box plot in figure 4 in the Appendix shows, at lower dosages, OJ causes more growth than VC.

------
# Appendix
## Extra Figures
```{r echo = FALSE,fig.height=4, fig.width=4}
boxplot(len ~ supp, data = tg, main="Figure 3: Means - OJ vs VC\n All Dosages")
```

```{r echo = FALSE,fig.height=4, fig.width=4}
boxplot(len ~ supp, data = tg_5_1, main="Figure 4: Means - OJ vs VC\n 0.5 mg & 1.0 mg")
```

## R Code Used in this Analysis
```
library(knitr)
library(ggplot2)
library(dplyr)

tg <- ToothGrowth
gp_df <- data.frame(supp = c("OJ","VC","OJ","VC","OJ","VC"), 
dose = c(0.5,0.5,1,1,2,2))
kable(gp_df)

tg_grouped_by_supp_dose <- tg %>% group_by(supp, dose)
summary_supp_dose <- tg_grouped_by_supp_dose %>% 
  summarise(means = mean(len), sd = sd(len))
summary_supp_dose <- summary_supp_dose %>% 
  mutate(label = paste(supp, dose, sep = "-"))
summary_supp_dose$label <- as.factor(summary_supp_dose$label)
summary_supp_dose$lbl2 <- reorder(summary_supp_dose$label, 
  summary_supp_dose$means)

g <- ggplot(summary_supp_dose, aes(y = means, x = lbl2, fill = supp))
g + geom_bar(stat = "identity") + xlab("Suppliment-Dose Category") + 
  ylab("Means of Length") + ggtitle("Figure 1")

qplot(as.factor(dose), len, data = tg, 
      color = as.factor(supp), 
      xlab = "Dosage(mg)", 
      ylab = "Tooth Length (microns)", 
      main = "Figure 2")

tg_5_1 <- tg %>% filter(dose == .5 | dose == 1.0)
t_tg_5_1 <- t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)$p.value

p_comp <- data.frame(Dosage_0_5_mg = c(.006,"-","-"), 
  Dosage_1_mg = c("-",.001,"-"), Dosage_2_mg = c("-","-",.96), 
row.names = c("0.5 mg", "1 mg", "2 mg"))
kable(p_comp, caption = expression("p Values of Suppliment - Dosage Groups"))

tg_1_2 <- tg %>% filter(dose == 2.0 | dose == 1.0)
t_tg_1_2 <- t.test(len ~ dose, data = tg_1_2, conf.level = 0.95)$p.value
tg_5_1 <- tg %>% filter(dose == .5 | dose == 1.0)
t_tg_5_1 <- t.test(len ~ dose, data = tg_5_1, conf.level = 0.95)$p.value
tg_5_2 <- tg %>% filter(dose == .5 | dose == 2.0)
t_tg_5_2 <- t.test(len ~ dose, data = tg_5_2, conf.level = 0.95)$p.value

p_comp <- data.frame(Dosage_0_5_mg = c("OJ > VC","-","-"), 
  Dosage_1_mg = c("-","OJ > VC","-"), Dosage_2_mg = c("-","-","OJ=VC"), 
  row.names = c("0.5 mg", "1 mg", "2 mg"))
kable(p_comp, caption = expression("Conclusions of Suppliment - Dosage Groups"))

boxplot(len ~ supp, data = tg, main="Figure 3: Means - OJ vs VC\n All Dosages")
boxplot(len ~ supp, data = tg_5_1, main="Figure 4: Means - OJ vs VC\n 0.5 mg & 1.0 mg")
```
